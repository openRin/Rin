# Rin éƒ¨ç½²æŒ‡å—

æœ¬æ–‡æ¡£å°†æŒ‡å¯¼æ‚¨ä»é›¶å¼€å§‹éƒ¨ç½² Rin åšå®¢ç³»ç»Ÿåˆ° Cloudflareã€‚

## å‰ç½®è¦æ±‚

- ä¸€ä¸ª GitHub è´¦å·
- ä¸€ä¸ª Cloudflare è´¦å·ï¼ˆå…è´¹ç‰ˆå³å¯ï¼‰
- å¤§çº¦ 10-15 åˆ†é’Ÿæ—¶é—´

## éƒ¨ç½²æ­¥éª¤

### ç¬¬ä¸€æ­¥ï¼šFork ä»“åº“

1. è®¿é—® [Rin GitHub ä»“åº“](https://github.com/openRin/Rin)
2. ç‚¹å‡»å³ä¸Šè§’çš„ **"Fork"** æŒ‰é’®
![1000000657](https://github.com/OXeu/Rin/assets/36541432/df3607ca-a8a9-49b8-92ce-6b348afeb13f)
3. é€‰æ‹©æ‚¨çš„ä¸ªäººè´¦æˆ·ï¼Œä¿æŒé»˜è®¤è®¾ç½®ï¼Œç‚¹å‡» **"Create fork"**

### è·å–ç”¨æˆ· ID ä¸ API ä»¤ç‰Œ

å‚ç…§ https://developers.cloudflare.com/workers/wrangler/ci-cd/ æ¥é…ç½® GitHub Actions æ‰€éœ€çš„ Cloudflare ç™»å½•ç¯å¢ƒå˜é‡

ID éšæ„ç‚¹å‡»ä¸€ä¸ªè‡ªå·±ç»‘å®šçš„åŸŸåï¼Œè¿›å…¥ååœ¨å³ä¾§ï¼ˆéœ€è¦å‘ä¸‹æ»‘åŠ¨ä¸€æ®µè·ç¦»ï¼‰å¯ä»¥æ‰¾åˆ°`è´¦æˆ·ID`

åˆ›å»º API ä»¤ç‰Œï¼šç‚¹å‡»å³ä¸Šè§’`å¤´åƒ` > `æˆ‘çš„ä¸ªäººèµ„æ–™` > `API ä»¤ç‰Œ` > `åˆ›å»ºä»¤ç‰Œ`ï¼Œæ¨¡æ¿é€‰æ‹©`ç¼–è¾‘ Cloudflare Workers`ï¼š
![1000000663](/cloudflare-api-key-cn.png)

åˆ›å»ºå®Œæˆåä¿å­˜ä»¤ç‰Œ

### ç¬¬äºŒæ­¥ï¼šé…ç½® GitHub Secrets

1. åœ¨æ‚¨ fork çš„ä»“åº“é¡µé¢ï¼Œç‚¹å‡» **"Settings"** æ ‡ç­¾
2. åœ¨å·¦ä¾§èœå•ä¸­ï¼Œå±•å¼€ **"Secrets and variables"**ï¼Œé€‰æ‹© **"Actions"**
3. ç‚¹å‡» **"New repository secret"** æŒ‰é’®ï¼Œæ·»åŠ ä»¥ä¸‹ Secretsï¼š

#### å¿…éœ€ Secrets

| Secret åç§° | å€¼                                           | è¯´æ˜ |
|------------|---------------------------------------------|------|
| `CLOUDFLARE_API_TOKEN` | `ThEApiKeyIsRaNdomStR1ngNearly40CharsLong` | Cloudflare API ä»¤ç‰Œ |
| `CLOUDFLARE_ACCOUNT_ID` | `0123456789abcdef0123456789abcdef`          | Cloudflare è´¦æˆ· ID |
| `JWT_SECRET` | ä»»æ„éšæœºå­—ç¬¦ä¸² | JWT ç­¾åå¯†é’¥ |

> **æç¤º**: JWT_SECRET å¯ä»¥æ˜¯ä»»æ„é•¿åº¦çš„éšæœºå­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ï¼š`MySecretKey123!@#`

#### ç™»å½•é…ç½® Secrets

Rin ç›®å‰æ”¯æŒè´¦å·å¯†ç ç™»å½•ä¸ Github OAuth ç™»å½•ï¼Œå¯äºŒé€‰ä¸€æˆ–åŒæ—¶é…ç½®

**è´¦å·å¯†ç ç™»å½•ï¼ˆæ¨èï¼‰**

| Secret åç§° | å€¼ | è¯´æ˜ |
|------------|-----|------|
| `ADMIN_USERNAME` | æ‚¨æƒ³è®¾ç½®çš„ç”¨æˆ·å | ç™»å½•ç”¨æˆ·å |
| `ADMIN_PASSWORD` | æ‚¨æƒ³è®¾ç½®çš„å¯†ç  | ç™»å½•å¯†ç  |


**GitHub OAuth ç™»å½•ï¼ˆå¯é€‰ï¼‰**

å¦‚æœæ‚¨æƒ³ä½¿ç”¨ GitHub è´¦å·ç™»å½•ï¼Œè¯·å‚è€ƒ[é«˜çº§é…ç½®](#github-oauth-é…ç½®)éƒ¨åˆ†æ·»åŠ  OAuth é…ç½®ã€‚

> **æç¤º**: è´¦å·å¯†ç ç™»å½•å’Œ GitHub OAuth ç™»å½•å¯ä»¥åŒæ—¶å¯ç”¨ï¼Œç”¨æˆ·å¯ä»¥åœ¨ç™»å½•é¡µé¢è‡ªç”±é€‰æ‹©ç™»å½•æ–¹å¼ã€‚

### ç¬¬ä¸‰æ­¥ï¼šè§¦å‘éƒ¨ç½²

1. è¿›å…¥ä»“åº“çš„ **"Actions"** æ ‡ç­¾
2. åœ¨å·¦ä¾§é€‰æ‹© **"Deploy"** å·¥ä½œæµ
3. ç‚¹å‡» **"Run workflow"** æŒ‰é’®
4. ä¿æŒé»˜è®¤åˆ†æ”¯ï¼ˆmainï¼‰ï¼Œç‚¹å‡» **"Run workflow"**

éƒ¨ç½²è¿‡ç¨‹å¤§çº¦éœ€è¦ 3-5 åˆ†é’Ÿã€‚æ‚¨å¯ä»¥åœ¨ Actions é¡µé¢æŸ¥çœ‹éƒ¨ç½²è¿›åº¦ã€‚

> **æç¤º**: éƒ¨ç½²è„šæœ¬ä¼šè‡ªåŠ¨é…ç½®å‰ç«¯ç¯å¢ƒå˜é‡ï¼Œæ— éœ€æ‰‹åŠ¨é…ç½®ã€‚æ‚¨å¯ä»¥åœ¨ GitHub Variables ä¸­è‡ªå®šä¹‰ç½‘ç«™åç§°ã€æè¿°ç­‰ï¼ˆå¯é€‰ï¼‰ã€‚

### ç¬¬å››æ­¥ï¼šè®¿é—®æ‚¨çš„åšå®¢

éƒ¨ç½²å®Œæˆåï¼Œæ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹åœ°å€è®¿é—®ï¼š

- **å‰ç«¯é¡µé¢**: `https://rin-client.pages.dev`ï¼ˆæˆ–æ‚¨åœ¨ `PAGES_NAME` ä¸­è®¾ç½®çš„åç§°ï¼‰
- **åç«¯ API**: `https://rin-server.your-account-id.workers.dev`

### ç¬¬äº”æ­¥ï¼šé¦–æ¬¡ç™»å½•

1. è®¿é—®å‰ç«¯é¡µé¢
2. ç‚¹å‡»å³ä¸Šè§’çš„ç™»å½•å›¾æ ‡
3. ä½¿ç”¨æ‚¨åœ¨ Secrets ä¸­è®¾ç½®çš„ `ADMIN_USERNAME` å’Œ `ADMIN_PASSWORD` ç™»å½•
4. ç™»å½•åï¼Œç‚¹å‡»å¤´åƒè¿›å…¥ **ä¸ªäººèµ„æ–™** é¡µé¢ï¼Œå¯ä»¥ä¿®æ”¹æ˜µç§°å’Œä¸Šä¼ å¤´åƒ

## å‘å¸ƒç¬¬ä¸€ç¯‡æ–‡ç« 

1. ç™»å½•åï¼Œç‚¹å‡»å³ä¸Šè§’çš„ **"å†™ä½œ"** æŒ‰é’®
2. å¡«å†™æ–‡ç« æ ‡é¢˜å’Œå†…å®¹
3. ç‚¹å‡» **"å‘å¸ƒ"** æŒ‰é’®

ğŸ‰ æ­å–œï¼æ‚¨çš„ Rin åšå®¢å·²ç»æˆåŠŸéƒ¨ç½²å¹¶å‘å¸ƒäº†ç¬¬ä¸€ç¯‡æ–‡ç« ï¼

---

## é«˜çº§é…ç½®

### è‡ªå®šä¹‰åŸŸå

1. ç™»å½• Cloudflare Dashboard
2. è¿›å…¥ **Pages** > æ‚¨çš„é¡¹ç›® > **è‡ªå®šä¹‰åŸŸ**
3. æŒ‰ç…§æç¤ºæ·»åŠ æ‚¨çš„åŸŸå

### å›¾ç‰‡å­˜å‚¨é…ç½®

é»˜è®¤æƒ…å†µä¸‹ï¼ŒRin ä½¿ç”¨ Cloudflare R2 å­˜å‚¨å›¾ç‰‡ã€‚å¦‚æœæ‚¨éœ€è¦é…ç½® S3 å…¼å®¹å­˜å‚¨ï¼š

æ·»åŠ ä»¥ä¸‹ Secretsï¼š

| Secret åç§° | è¯´æ˜ |
|------------|------|
| `S3_ENDPOINT` | S3 ç«¯ç‚¹åœ°å€ |
| `S3_ACCESS_KEY_ID` | Access Key ID |
| `S3_SECRET_ACCESS_KEY` | Secret Access Key |
| `S3_BUCKET` | å­˜å‚¨æ¡¶åç§° |

### GitHub OAuth é…ç½®

å¦‚æœæ‚¨æƒ³ä½¿ç”¨ GitHub è´¦å·ç™»å½•ï¼š

1. è®¿é—® GitHub Settings > Developer settings > OAuth Apps
2. ç‚¹å‡» **"New OAuth App"**
3. å¡«å†™åº”ç”¨ä¿¡æ¯ï¼š
   - **Application name**: Rin Blog
   - **Homepage URL**: æ‚¨çš„å‰ç«¯é¡µé¢åœ°å€
   - **Authorization callback URL**: `https://your-worker-name.your-account-id.workers.dev/user/github/callback`
4. åˆ›å»ºåï¼Œè·å– Client ID å’Œ Client Secret
5. åœ¨ GitHub Secrets ä¸­æ·»åŠ ï¼š
   - `RIN_GITHUB_CLIENT_ID`
   - `RIN_GITHUB_CLIENT_SECRET`

---

## æ•…éšœæ’é™¤

### éƒ¨ç½²å¤±è´¥

1. æ£€æŸ¥ GitHub Secrets æ˜¯å¦æ­£ç¡®é…ç½®
2. æŸ¥çœ‹ Actions æ—¥å¿—è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯
3. ç¡®ä¿ Cloudflare è´¦æˆ·æœ‰ Workersã€Pagesã€D1 çš„æƒé™

### æ— æ³•ç™»å½•

1. ç¡®è®¤ `ADMIN_USERNAME` å’Œ `ADMIN_PASSWORD` å·²æ­£ç¡®è®¾ç½®
2. æ£€æŸ¥ Worker æ—¥å¿—æŸ¥çœ‹è®¤è¯é”™è¯¯
3. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜åé‡è¯•

### æ•°æ®åº“è¿ç§»å¤±è´¥

éƒ¨ç½²è„šæœ¬ä¼šè‡ªåŠ¨è¿è¡Œæ•°æ®åº“è¿ç§»ã€‚å¦‚æœå¤±è´¥ï¼š

1. æ‰‹åŠ¨è¿›å…¥ Cloudflare Dashboard > D1
2. æ‰¾åˆ°æ‚¨çš„æ•°æ®åº“ï¼Œç‚¹å‡» **"Console"**
3. æ‰‹åŠ¨æ‰§è¡Œè¿ç§» SQLï¼ˆå‚è€ƒ `server/migrations/` ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼‰

---

## æ›´æ–°åšå®¢

å½“æœ‰æ–°ç‰ˆæœ¬å‘å¸ƒæ—¶ï¼š

1. åœ¨æ‚¨çš„ fork ä»“åº“é¡µé¢ç‚¹å‡» **"Sync fork"**
2. ç‚¹å‡» **"Update branch"**
3. éƒ¨ç½²ä¼šè‡ªåŠ¨è§¦å‘

æˆ–è€…æ‰‹åŠ¨æ›´æ–°ï¼š

```bash
git remote add upstream https://github.com/openRin/Rin.git
git fetch upstream
git checkout main
git merge upstream/main
git push origin main
```

---

## éœ€è¦å¸®åŠ©ï¼Ÿ

- ğŸ“– [å®Œæ•´æ–‡æ¡£](https://docs.openrin.org)
- ğŸ› [GitHub Issues](https://github.com/openRin/Rin/issues)
- ğŸ’¬ [GitHub Discussions](https://github.com/openRin/Rin/discussions)
